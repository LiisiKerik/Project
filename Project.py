#############################################################################################################################
from copy import *
from fractions import *
from math import *
from random import *
from time import *
def Abs_error_scalar(x, y):
  return(abs(y - x))
def Actions():
  return([("TESTS", Tests), ("ERRORS", Errors), ("TIMES", Times)])
def Adj_Det():
  return([Adj_Det_Berkowitz])
def Adj_Det_Berkowitz(x):
  n = len(x)
  if n == 0:
    return(([], 1))
  elif n == 1:
    return([[1]], -x[0][0])
  else:
    n = len(x)
    c = Characteristic_Berkowitz_2(n, x)
    p = Powers(range(n), n - 1, x)
    a = Sum(range(n), range(n), [Multiply_scalar_matrix(c[i + 2], p[i]) for i in range(n - 2)] + [p[n - 2]])
    for i in range(n):
      a[i][i] += c[1]
    return((a, c[0]))
def Adj_Det_tests():
  return(
    [
      ([], ([], 1)),
      ([[-1]], ([[1]], 1)),
      ([[0]], ([[1]], 0)),
      ([[1]], ([[1]], -1)),
      ([[-1, -1], [-1, -1]], ([[1, -1], [-1, 1]], 0)),
      ([[-1, -1], [-1, 0]], ([[0, -1], [-1, 1]], -1)),
      ([[-1, -1], [-1, 1]], ([[-1, -1], [-1, 1]], -2)),
      ([[-1, -1], [0, -1]], ([[1, -1], [0, 1]], 1)),
      ([[-1, -1], [0, 0]], ([[0, -1], [0, 1]], 0)),
      ([[-1, -1], [0, 1]], ([[-1, -1], [0, 1]], -1)),
      ([[-1, -1], [1, -1]], ([[1, -1], [1, 1]], 2)),
      ([[-1, -1], [1, 0]], ([[0, -1], [1, 1]], 1)),
      ([[-1, -1], [1, 1]], ([[-1, -1], [1, 1]], 0)),
      ([[-1, 0], [-1, -1]], ([[1, 0], [-1, 1]], 1)),
      ([[-1, 0], [-1, 0]], ([[0, 0], [-1, 1]], 0)),
      ([[-1, 0], [-1, 1]], ([[-1, 0], [-1, 1]], -1)),
      ([[-1, 0], [0, -1]], ([[1, 0], [0, 1]], 1)),
      ([[-1, 0], [0, 0]], ([[0, 0], [0, 1]], 0)),
      ([[-1, 0], [0, 1]], ([[-1, 0], [0, 1]], -1)),
      ([[-1, 0], [1, -1]], ([[1, 0], [1, 1]], 1)),
      ([[-1, 0], [1, 0]], ([[0, 0], [1, 1]], 0)),
      ([[-1, 0], [1, 1]], ([[-1, 0], [1, 1]], -1)),
      ([[-1, 1], [-1, -1]], ([[1, 1], [-1, 1]], 2)),
      ([[-1, 1], [-1, 0]], ([[0, 1], [-1, 1]], 1)),
      ([[-1, 1], [-1, 1]], ([[-1, 1], [-1, 1]], 0)),
      ([[-1, 1], [0, -1]], ([[1, 1], [0, 1]], 1)),
      ([[-1, 1], [0, 0]], ([[0, 1], [0, 1]], 0)),
      ([[-1, 1], [0, 1]], ([[-1, 1], [0, 1]], -1)),
      ([[-1, 1], [1, -1]], ([[1, 1], [1, 1]], 0)),
      ([[-1, 1], [1, 0]], ([[0, 1], [1, 1]], -1)),
      ([[-1, 1], [1, 1]], ([[-1, 1], [1, 1]], -2)),
      ([[0, -1], [-1, -1]], ([[1, -1], [-1, 0]], -1)),
      ([[0, -1], [-1, 0]], ([[0, -1], [-1, 0]], -1)),
      ([[0, -1], [-1, 1]], ([[-1, -1], [-1, 0]], -1)),
      ([[0, -1], [0, -1]], ([[1, -1], [0, 0]], 0)),
      ([[0, -1], [0, 0]], ([[0, -1], [0, 0]], 0)),
      ([[0, -1], [0, 1]], ([[-1, -1], [0, 0]], 0)),
      ([[0, -1], [1, -1]], ([[1, -1], [1, 0]], 1)),
      ([[0, -1], [1, 0]], ([[0, -1], [1, 0]], 1)),
      ([[0, -1], [1, 1]], ([[-1, -1], [1, 0]], 1)),
      ([[0, 0], [-1, -1]], ([[1, 0], [-1, 0]], 0)),
      ([[0, 0], [-1, 0]], ([[0, 0], [-1, 0]], 0)),
      ([[0, 0], [-1, 1]], ([[-1, 0], [-1, 0]], 0)),
      ([[0, 0], [0, -1]], ([[1, 0], [0, 0]], 0)),
      ([[0, 0], [0, 0]], ([[0, 0], [0, 0]], 0)),
      ([[0, 0], [0, 1]], ([[-1, 0], [0, 0]], 0)),
      ([[0, 0], [1, -1]], ([[1, 0], [1, 0]], 0)),
      ([[0, 0], [1, 0]], ([[0, 0], [1, 0]], 0)),
      ([[0, 0], [1, 1]], ([[-1, 0], [1, 0]], 0)),
      ([[0, 1], [-1, -1]], ([[1, 1], [-1, 0]], 1)),
      ([[0, 1], [-1, 0]], ([[0, 1], [-1, 0]], 1)),
      ([[0, 1], [-1, 1]], ([[-1, 1], [-1, 0]], 1)),
      ([[0, 1], [0, -1]], ([[1, 1], [0, 0]], 0)),
      ([[0, 1], [0, 0]], ([[0, 1], [0, 0]], 0)),
      ([[0, 1], [0, 1]], ([[-1, 1], [0, 0]], 0)),
      ([[0, 1], [1, -1]], ([[1, 1], [1, 0]], -1)),
      ([[0, 1], [1, 0]], ([[0, 1], [1, 0]], -1)),
      ([[0, 1], [1, 1]], ([[-1, 1], [1, 0]], -1)),
      ([[1, -1], [-1, -1]], ([[1, -1], [-1, -1]], -2)),
      ([[1, -1], [-1, 0]], ([[0, -1], [-1, -1]], -1)),
      ([[1, -1], [-1, 1]], ([[-1, -1], [-1, -1]], 0)),
      ([[1, -1], [0, -1]], ([[1, -1], [0, -1]], -1)),
      ([[1, -1], [0, 0]], ([[0, -1], [0, -1]], 0)),
      ([[1, -1], [0, 1]], ([[-1, -1], [0, -1]], 1)),
      ([[1, -1], [1, -1]], ([[1, -1], [1, -1]], 0)),
      ([[1, -1], [1, 0]], ([[0, -1], [1, -1]], 1)),
      ([[1, -1], [1, 1]], ([[-1, -1], [1, -1]], 2)),
      ([[1, 0], [-1, -1]], ([[1, 0], [-1, -1]], -1)),
      ([[1, 0], [-1, 0]], ([[0, 0], [-1, -1]], 0)),
      ([[1, 0], [-1, 1]], ([[-1, 0], [-1, -1]], 1)),
      ([[1, 0], [0, -1]], ([[1, 0], [0, -1]], -1)),
      ([[1, 0], [0, 0]], ([[0, 0], [0, -1]], 0)),
      ([[1, 0], [0, 1]], ([[-1, 0], [0, -1]], 1)),
      ([[1, 0], [1, -1]], ([[1, 0], [1, -1]], -1)),
      ([[1, 0], [1, 0]], ([[0, 0], [1, -1]], 0)),
      ([[1, 0], [1, 1]], ([[-1, 0], [1, -1]], 1)),
      ([[1, 1], [-1, -1]], ([[1, 1], [-1, -1]], 0)),
      ([[1, 1], [-1, 0]], ([[0, 1], [-1, -1]], 1)),
      ([[1, 1], [-1, 1]], ([[-1, 1], [-1, -1]], 2)),
      ([[1, 1], [0, -1]], ([[1, 1], [0, -1]], -1)),
      ([[1, 1], [0, 0]], ([[0, 1], [0, -1]], 0)),
      ([[1, 1], [0, 1]], ([[-1, 1], [0, -1]], 1)),
      ([[1, 1], [1, -1]], ([[1, 1], [1, -1]], -2)),
      ([[1, 1], [1, 0]], ([[0, 1], [1, -1]], -1)),
      ([[1, 1], [1, 1]], ([[-1, 1], [1, -1]], 0)),
      ([[1, 2, 5], [4, 1, 7], [3, 3, 7]], ([[-14, 1, 9], [-7, -8, 13], [9, 3, -7]], -17)),
      (
        [[3, 2, 1, 5], [1, 2, 5, 2], [9, 4, 1, 7], [2, 3, 3, 7]],
        ([[45, 10, -5, -30], [-209, -34, 49, 110], [53, 18, -13, -30], [54, 4, -14, -20]], -40))])
def Characteristic():
  return([Characteristic_Berkowitz])
def Characteristic_Berkowitz(x):
  if x == []:
    return([])
  else:
    return(Characteristic_Berkowitz_1(len(x), x))
def Characteristic_Berkowitz_1(n, x):
  return([-x[0][0]] if n == 1 else Characteristic_Berkowitz_2(n, x))
def Characteristic_Berkowitz_2(n, x):
  Column = [y[0] for y in x[1 :]]
  Matrix = [y[1 :] for y in x[1 :]]
  c = Characteristic_Berkowitz_1(n - 1, Matrix)
  q = [x[0][1 :]]
  for i in range(n - 2):
    q += [Multiply_vector_matrix(range(n - 1), range(n - 1), q[i], Matrix)]
  p = [x[0][0]] + [Multiply_vector_vector(range(n - 1), q[i], Column) for i in range(n - 1)]
  a = [Multiply_vector_vector(range(n - 1 - i), p, c[i :]) + p[n - 1 - i] for i in range(n)]
  return([-a[0]] + [c[i - 1] - a[i] for i in range(1, n)])
def Characteristic_tests():
  return(
    [
      ([], []),
      ([[-1]], [1]),
      ([[0]], [0]),
      ([[1]], [-1]),
      ([[-1, -1], [-1, -1]], [0, 2]),
      ([[-1, -1], [-1, 0]], [-1, 1]),
      ([[-1, -1], [-1, 1]], [-2, 0]),
      ([[-1, -1], [0, -1]], [1, 2]),
      ([[-1, -1], [0, 0]], [0, 1]),
      ([[-1, -1], [0, 1]], [-1, 0]),
      ([[-1, -1], [1, -1]], [2, 2]),
      ([[-1, -1], [1, 0]], [1, 1]),
      ([[-1, -1], [1, 1]], [0, 0]),
      ([[-1, 0], [-1, -1]], [1, 2]),
      ([[-1, 0], [-1, 0]], [0, 1]),
      ([[-1, 0], [-1, 1]], [-1, 0]),
      ([[-1, 0], [0, -1]], [1, 2]),
      ([[-1, 0], [0, 0]], [0, 1]),
      ([[-1, 0], [0, 1]], [-1, 0]),
      ([[-1, 0], [1, -1]], [1, 2]),
      ([[-1, 0], [1, 0]], [0, 1]),
      ([[-1, 0], [1, 1]], [-1, 0]),
      ([[-1, 1], [-1, -1]], [2, 2]),
      ([[-1, 1], [-1, 0]], [1, 1]),
      ([[-1, 1], [-1, 1]], [0, 0]),
      ([[-1, 1], [0, -1]], [1, 2]),
      ([[-1, 1], [0, 0]], [0, 1]),
      ([[-1, 1], [0, 1]], [-1, 0]),
      ([[-1, 1], [1, -1]], [0, 2]),
      ([[-1, 1], [1, 0]], [-1, 1]),
      ([[-1, 1], [1, 1]], [-2, 0]),
      ([[0, -1], [-1, -1]], [-1, 1]),
      ([[0, -1], [-1, 0]], [-1, 0]),
      ([[0, -1], [-1, 1]], [-1, -1]),
      ([[0, -1], [0, -1]], [0, 1]),
      ([[0, -1], [0, 0]], [0, 0]),
      ([[0, -1], [0, 1]], [0, -1]),
      ([[0, -1], [1, -1]], [1, 1]),
      ([[0, -1], [1, 0]], [1, 0]),
      ([[0, -1], [1, 1]], [1, -1]),
      ([[0, 0], [-1, -1]], [0, 1]),
      ([[0, 0], [-1, 0]], [0, 0]),
      ([[0, 0], [-1, 1]], [0, -1]),
      ([[0, 0], [0, -1]], [0, 1]),
      ([[0, 0], [0, 0]], [0, 0]),
      ([[0, 0], [0, 1]], [0, -1]),
      ([[0, 0], [1, -1]], [0, 1]),
      ([[0, 0], [1, 0]], [0, 0]),
      ([[0, 0], [1, 1]], [0, -1]),
      ([[0, 1], [-1, -1]], [1, 1]),
      ([[0, 1], [-1, 0]], [1, 0]),
      ([[0, 1], [-1, 1]], [1, -1]),
      ([[0, 1], [0, -1]], [0, 1]),
      ([[0, 1], [0, 0]], [0, 0]),
      ([[0, 1], [0, 1]], [0, -1]),
      ([[0, 1], [1, -1]], [-1, 1]),
      ([[0, 1], [1, 0]], [-1, 0]),
      ([[0, 1], [1, 1]], [-1, -1]),
      ([[1, -1], [-1, -1]], [-2, 0]),
      ([[1, -1], [-1, 0]], [-1, -1]),
      ([[1, -1], [-1, 1]], [0, -2]),
      ([[1, -1], [0, -1]], [-1, 0]),
      ([[1, -1], [0, 0]], [0, -1]),
      ([[1, -1], [0, 1]], [1, -2]),
      ([[1, -1], [1, -1]], [0, 0]),
      ([[1, -1], [1, 0]], [1, -1]),
      ([[1, -1], [1, 1]], [2, -2]),
      ([[1, 0], [-1, -1]], [-1, 0]),
      ([[1, 0], [-1, 0]], [0, -1]),
      ([[1, 0], [-1, 1]], [1, -2]),
      ([[1, 0], [0, -1]], [-1, 0]),
      ([[1, 0], [0, 0]], [0, -1]),
      ([[1, 0], [0, 1]], [1, -2]),
      ([[1, 0], [1, -1]], [-1, 0]),
      ([[1, 0], [1, 0]], [0, -1]),
      ([[1, 0], [1, 1]], [1, -2]),
      ([[1, 1], [-1, -1]], [0, 0]),
      ([[1, 1], [-1, 0]], [1, -1]),
      ([[1, 1], [-1, 1]], [2, -2]),
      ([[1, 1], [0, -1]], [-1, 0]),
      ([[1, 1], [0, 0]], [0, -1]),
      ([[1, 1], [0, 1]], [1, -2]),
      ([[1, 1], [1, -1]], [-2, 0]),
      ([[1, 1], [1, 0]], [-1, -1]),
      ([[1, 1], [1, 1]], [0, -2]),
      ([[1, 2, 5], [4, 1, 7], [3, 3, 7]], [-17, -29, -9]),
      ([[3, 2, 1, 5], [1, 2, 5, 2], [9, 4, 1, 7], [2, 3, 3, 7]], [-40, -22, -15, -13])])
def Det():
  return([Det_Berkowitz, Det_Gaussian_elimination])
def Det_Berkowitz(x):
  if x == []:
    return(1)
  else:
    n = len(x)
    (a, d) = Adj_Det_Berkowitz([y[1 :] for y in x[1 :]])
    r = x[0][0] * d + Multiply_vector_matrix_vector(range(n - 1), range(n - 1), x[0][1 :], a, [y[0] for y in x[1 :]])
    return(-r if n % 2 == 0 else r)
def Det_Gaussian_elimination(x_ref):
  x = deepcopy(x_ref)
  n = len(x)
  Det = 1
  for i in range(n):
    Nonzero = False
    for j in range(i, n):
      if x[j][i] != 0:
        Nonzero = True
        if j != i:
          Det = -Det
          for k in range(i, n):
            x[i][k], x[j][k] = x[j][k], x[i][k]
        break
    if Nonzero:
      Pivot = x[i][i]
      Det *= Pivot
      Inv_pivot = 1 / Pivot
      for j in range(i + 1, n):
        x[i][j] *= Inv_pivot
      for j in range(i + 1, n):
        for k in range(i + 1, n):
          x[j][k] -= x[j][i] * x[i][k]
    else:
      return(0)
  return(Det)
def Det_tests():
  return(
    [
      ([], 1),
      ([[-1]], -1),
      ([[0]], 0),
      ([[1]], 1),
      ([[-1, -1], [-1, -1]], 0),
      ([[-1, -1], [-1, 0]], -1),
      ([[-1, -1], [-1, 1]], -2),
      ([[-1, -1], [0, -1]], 1),
      ([[-1, -1], [0, 0]], 0),
      ([[-1, -1], [0, 1]], -1),
      ([[-1, -1], [1, -1]], 2),
      ([[-1, -1], [1, 0]], 1),
      ([[-1, -1], [1, 1]], 0),
      ([[-1, 0], [-1, -1]], 1),
      ([[-1, 0], [-1, 0]], 0),
      ([[-1, 0], [-1, 1]], -1),
      ([[-1, 0], [0, -1]], 1),
      ([[-1, 0], [0, 0]], 0),
      ([[-1, 0], [0, 1]], -1),
      ([[-1, 0], [1, -1]], 1),
      ([[-1, 0], [1, 0]], 0),
      ([[-1, 0], [1, 1]], -1),
      ([[-1, 1], [-1, -1]], 2),
      ([[-1, 1], [-1, 0]], 1),
      ([[-1, 1], [-1, 1]], 0),
      ([[-1, 1], [0, -1]], 1),
      ([[-1, 1], [0, 0]], 0),
      ([[-1, 1], [0, 1]], -1),
      ([[-1, 1], [1, -1]], 0),
      ([[-1, 1], [1, 0]], -1),
      ([[-1, 1], [1, 1]], -2),
      ([[0, -1], [-1, -1]], -1),
      ([[0, -1], [-1, 0]], -1),
      ([[0, -1], [-1, 1]], -1),
      ([[0, -1], [0, -1]], 0),
      ([[0, -1], [0, 0]], 0),
      ([[0, -1], [0, 1]], 0),
      ([[0, -1], [1, -1]], 1),
      ([[0, -1], [1, 0]], 1),
      ([[0, -1], [1, 1]], 1),
      ([[0, 0], [-1, -1]], 0),
      ([[0, 0], [-1, 0]], 0),
      ([[0, 0], [-1, 1]], 0),
      ([[0, 0], [0, -1]], 0),
      ([[0, 0], [0, 0]], 0),
      ([[0, 0], [0, 1]], 0),
      ([[0, 0], [1, -1]], 0),
      ([[0, 0], [1, 0]], 0),
      ([[0, 0], [1, 1]], 0),
      ([[0, 1], [-1, -1]], 1),
      ([[0, 1], [-1, 0]], 1),
      ([[0, 1], [-1, 1]], 1),
      ([[0, 1], [0, -1]], 0),
      ([[0, 1], [0, 0]], 0),
      ([[0, 1], [0, 1]], 0),
      ([[0, 1], [1, -1]], -1),
      ([[0, 1], [1, 0]], -1),
      ([[0, 1], [1, 1]], -1),
      ([[1, -1], [-1, -1]], -2),
      ([[1, -1], [-1, 0]], -1),
      ([[1, -1], [-1, 1]], 0),
      ([[1, -1], [0, -1]], -1),
      ([[1, -1], [0, 0]], 0),
      ([[1, -1], [0, 1]], 1),
      ([[1, -1], [1, -1]], 0),
      ([[1, -1], [1, 0]], 1),
      ([[1, -1], [1, 1]], 2),
      ([[1, 0], [-1, -1]], -1),
      ([[1, 0], [-1, 0]], 0),
      ([[1, 0], [-1, 1]], 1),
      ([[1, 0], [0, -1]], -1),
      ([[1, 0], [0, 0]], 0),
      ([[1, 0], [0, 1]], 1),
      ([[1, 0], [1, -1]], -1),
      ([[1, 0], [1, 0]], 0),
      ([[1, 0], [1, 1]], 1),
      ([[1, 1], [-1, -1]], 0),
      ([[1, 1], [-1, 0]], 1),
      ([[1, 1], [-1, 1]], 2),
      ([[1, 1], [0, -1]], -1),
      ([[1, 1], [0, 0]], 0),
      ([[1, 1], [0, 1]], 1),
      ([[1, 1], [1, -1]], -2),
      ([[1, 1], [1, 0]], -1),
      ([[1, 1], [1, 1]], 0),
      ([[1, 2, 5], [4, 1, 7], [3, 3, 7]], 17),
      ([[3, 2, 1, 5], [1, 2, 5, 2], [9, 4, 1, 7], [2, 3, 3, 7]], -40)])
def Div(x, y):
  return([[w / y for w in z] for z in x])
def Equal_matrix(x, y):
  for i in range(len(x)):
    for j in range(len(x[0])):
      if not(Equal_scalar(x[i][j], y[i][j])):
        return(False)
  return(True)
def Equal_matrix_scalar(x, y):
  (a, b) = x
  (c, d) = y
  return(Equal_matrix(a, c) and Equal_scalar(b, d))
def Equal_maybe_matrix(x, y):
  return(y == None if x == None else False if y == None else Equal_matrix(x, y))
def Equal_scalar(x, y):
  return(Round(x) == Round(y))
def Equal_vector(x, y):
  return(x == y)
def Error_matrix(x, y):
  return(0 if x == None else sqrt(sum(sum([(y[i][j] - x[i][j]) ** 2 for j in range(len(x[0]))]) for i in range(len(x))))) 
def Errors():
  for (fname, f, errs, Etalon, Num_tests) in Measure_functions():
    Names(f)
    e = len(errs)
    l = len(f)
    Results = [[[] for _ in f] for _ in errs]
    n = 0
    while(True):
      x =\
        [(a, Etalon([[Fraction(Element) for Element in Row] for Row in a]))
        for a in [[[uniform(-1, 1) for _ in range(n)] for _ in range(n)] for _ in range(Num_tests)]]
      Timesum = 0
      for i in range(l):
        fi = f[i]
        Errsum = [[] for _ in errs]
        for j in range(Num_tests):
          xj = x[j][0]
          Start = clock()
          y = fi(xj)
          End = clock()
          Timesum += End - Start
          for t in range(e):
            Errsum[t] += [errs[t][1](x[j][1], y)]
        for t in range(e):
          Results[t][i] += [Median(Errsum[t])]
      n += 1
      if Timesum > 15 * l:
        break
    for t in range(e):
      Write(n, l, "Error_" + fname + "_" + errs[t][0], Results[t])
def Identity(n):
  return([[1 if j == i else 0 for j in n] for i in n])
def Inv():
  return([Inv_Berkowitz, Inv_Gaussian_elimination])
def Inv_Berkowitz(x):
  (a, d) = Adj_Det_Berkowitz(x)
  return(None if d == 0 else Div(a, -d))
def Inv_Gaussian_elimination(x_ref):
  x = deepcopy(x_ref)
  n = len(x)
  Inverse = Identity(range(n))
  for i in range(n):
    Nonzero = False
    for j in range(i, n):
      if x[j][i] != 0:
        Nonzero = True
        if j != i:
          for k in range(i, n):
            x[i][k], x[j][k] = x[j][k], x[i][k]
          for k in range(n):
            Inverse[i][k], Inverse[j][k] = Inverse[j][k], Inverse[i][k]
        break
    if Nonzero:
      Inv_pivot = 1 / x[i][i]
      for j in range(i + 1, n):
        x[i][j] *= Inv_pivot
      for j in range(n):
        Inverse[i][j] *= Inv_pivot
      for j in list(range(i)) + list(range(i + 1, n)):
        for k in range(i + 1, n):
          x[j][k] -= x[j][i] * x[i][k]
        for k in range(n):
          Inverse[j][k] -= x[j][i] * Inverse[i][k]
    else:
      return(None)
  return(Inverse)
def Inv_tests():
  return(
    [
      ([], []),
      ([[-1]], [[-1]]),
      ([[0]], None),
      ([[1]], [[1]]),
      ([[-1, -1], [-1, -1]], None),
      ([[-1, -1], [-1, 0]], [[0, -1], [-1, 1]]),
      ([[-1, -1], [-1, 1]], [[-0.5, -0.5], [-0.5, 0.5]]),
      ([[-1, -1], [0, -1]], [[-1, 1], [0, -1]]),
      ([[-1, -1], [0, 0]], None),
      ([[-1, -1], [0, 1]], [[-1, -1], [0, 1]]),
      ([[-1, -1], [1, -1]], [[-0.5, 0.5], [-0.5, -0.5]]),
      ([[-1, -1], [1, 0]], [[0, 1], [-1, -1]]),
      ([[-1, -1], [1, 1]], None),
      ([[-1, 0], [-1, -1]], [[-1, 0], [1, -1]]),
      ([[-1, 0], [-1, 0]], None),
      ([[-1, 0], [-1, 1]], [[-1, 0], [-1, 1]]),
      ([[-1, 0], [0, -1]], [[-1, 0], [0, -1]]),
      ([[-1, 0], [0, 0]], None),
      ([[-1, 0], [0, 1]], [[-1, 0], [0, 1]]),
      ([[-1, 0], [1, -1]], [[-1, 0], [-1, -1]]),
      ([[-1, 0], [1, 0]], None),
      ([[-1, 0], [1, 1]], [[-1, 0], [1, 1]]),
      ([[-1, 1], [-1, -1]], [[-0.5, -0.5], [0.5, -0.5]]),
      ([[-1, 1], [-1, 0]], [[0, -1], [1, -1]]),
      ([[-1, 1], [-1, 1]], None),
      ([[-1, 1], [0, -1]], [[-1, -1], [0, -1]]),
      ([[-1, 1], [0, 0]], None),
      ([[-1, 1], [0, 1]], [[-1, 1], [0, 1]]),
      ([[-1, 1], [1, -1]], None),
      ([[-1, 1], [1, 0]], [[0, 1], [1, 1]]),
      ([[-1, 1], [1, 1]], [[-0.5, 0.5], [0.5, 0.5]]),
      ([[0, -1], [-1, -1]], [[1, -1], [-1, 0]]),
      ([[0, -1], [-1, 0]], [[0, -1], [-1, 0]]),
      ([[0, -1], [-1, 1]], [[-1, -1], [-1, 0]]),
      ([[0, -1], [0, -1]], None),
      ([[0, -1], [0, 0]], None),
      ([[0, -1], [0, 1]], None),
      ([[0, -1], [1, -1]], [[-1, 1], [-1, 0]]),
      ([[0, -1], [1, 0]], [[0, 1], [-1, 0]]),
      ([[0, -1], [1, 1]], [[1, 1], [-1, 0]]),
      ([[0, 0], [-1, -1]], None),
      ([[0, 0], [-1, 0]], None),
      ([[0, 0], [-1, 1]], None),
      ([[0, 0], [0, -1]], None),
      ([[0, 0], [0, 0]], None),
      ([[0, 0], [0, 1]], None),
      ([[0, 0], [1, -1]], None),
      ([[0, 0], [1, 0]], None),
      ([[0, 0], [1, 1]], None),
      ([[0, 1], [-1, -1]], [[-1, -1], [1, 0]]),
      ([[0, 1], [-1, 0]], [[0, -1], [1, 0]]),
      ([[0, 1], [-1, 1]], [[1, -1], [1, 0]]),
      ([[0, 1], [0, -1]], None),
      ([[0, 1], [0, 0]], None),
      ([[0, 1], [0, 1]], None),
      ([[0, 1], [1, -1]], [[1, 1], [1, 0]]),
      ([[0, 1], [1, 0]], [[0, 1], [1, 0]]),
      ([[0, 1], [1, 1]], [[-1, 1], [1, 0]]),
      ([[1, -1], [-1, -1]], [[0.5, -0.5], [-0.5, -0.5]]),
      ([[1, -1], [-1, 0]], [[0, -1], [-1, -1]]),
      ([[1, -1], [-1, 1]], None),
      ([[1, -1], [0, -1]], [[1, -1], [0, -1]]),
      ([[1, -1], [0, 0]], None),
      ([[1, -1], [0, 1]], [[1, 1], [0, 1]]),
      ([[1, -1], [1, -1]], None),
      ([[1, -1], [1, 0]], [[0, 1], [-1, 1]]),
      ([[1, -1], [1, 1]], [[0.5, 0.5], [-0.5, 0.5]]),
      ([[1, 0], [-1, -1]], [[1, 0], [-1, -1]]),
      ([[1, 0], [-1, 0]], None),
      ([[1, 0], [-1, 1]], [[1, 0], [1, 1]]),
      ([[1, 0], [0, -1]], [[1, 0], [0, -1]]),
      ([[1, 0], [0, 0]], None),
      ([[1, 0], [0, 1]], [[1, 0], [0, 1]]),
      ([[1, 0], [1, -1]], [[1, 0], [1, -1]]),
      ([[1, 0], [1, 0]], None),
      ([[1, 0], [1, 1]], [[1, 0], [-1, 1]]),
      ([[1, 1], [-1, -1]], None),
      ([[1, 1], [-1, 0]], [[0, -1], [1, 1]]),
      ([[1, 1], [-1, 1]], [[0.5, -0.5], [0.5, 0.5]]),
      ([[1, 1], [0, -1]], [[1, 1], [0, -1]]),
      ([[1, 1], [0, 0]], None),
      ([[1, 1], [0, 1]], [[1, -1], [0, 1]]),
      ([[1, 1], [1, -1]], [[0.5, 0.5], [0.5, -0.5]]),
      ([[1, 1], [1, 0]], [[0, 1], [1, -1]]),
      ([[1, 1], [1, 1]], None),
      ([[1, 2, 5], [4, 1, 7], [3, 3, 7]], Div([[-14, 1, 9], [-7, -8, 13], [9, 3, -7]], 17)),
      (
        [[3, 2, 1, 5], [1, 2, 5, 2], [9, 4, 1, 7], [2, 3, 3, 7]],
        [
          [1.125, 0.25, -0.125, -0.75],
          [-5.225, -0.85, 1.225, 2.75],
          [1.325, 0.45, -0.325, -0.75],
          [1.35, 0.1, -0.35, -0.5]])])
def Measure_functions():
  return(
    [
      ("Det", Det(), [("Abs", Abs_error_scalar), ("Rel", Rel_error_scalar)], Det_Gaussian_elimination, 10000),
      ("Inv", Inv(), [("Distance", Error_matrix)], Inv_Gaussian_elimination, 10000)])
def Median(x):
  n = len(x)
  x.sort()
  return((x[n // 2 - 1] + x[n // 2]) / 2 if n % 2 == 0 else x[n // 2])
def Multiply_matrix_matrix(l, m, n, x, y):
  return([[sum([x[i][k] * y[k][j] for k in m]) for j in n] for i in l])
def Multiply_scalar_matrix(x, y):
  return([[x * w for w in z] for z in y])
def Multiply_vector_matrix(m, n, x, y):
  return([sum([x[j] * y[j][i] for j in m]) for i in n])
def Multiply_vector_matrix_vector(m, n, x, y, z):
  return(Multiply_vector_vector(n, Multiply_vector_matrix(m, n, x, y), z))
def Multiply_vector_vector(n, x, y):
  return(sum([x[i] * y[i] for i in n]))
def Name(x):
  print(x.__name__)
def Names(x):
  return(print("[" + ", ".join([y.__name__ for y in x]) + "]"))
def Negate(m, n, x):
  return([[-x[i][j] for j in n] for i in m])
def Newline():
  print("\n")
def Or(x):
  for y in x:
    if y:
      return(True)
  return(False)
def Powers(m, n, x):
  Result = [None for _ in range(n)]
  if n != 0:
    Result[0] = x
    for i in range(n - 1):
      Result[i + 1] = Multiply_matrix_matrix(m, m, m, x, Result[i])
  return(Result)
def Rel_error_scalar(x, y):
  return(0 if x == 0 else abs((y - x) / x))
def Round(x):
  return(0 if x == 0 else -Round_1(-x) if x < 0 else Round_1(x))
def Round_1(x):
  if x < 10000:
    i = 0
    while 10 ** i * x < 1000:
      i += 1
  else:
    i = -1
    while 10 ** i * x >= 10000:
      i -= 1
  y = int(floor(10 ** i * x))
  return((y // 10 + y % 10 // 5) / 10 ** (i - 1))
def Sum(m, n, x):
  return([[sum([y[i][j] for y in x]) for j in n] for i in m])
def Test_functions():
  return(
    [
      (Adj_Det(), Adj_Det_tests(), Equal_matrix_scalar),
      (Characteristic(), Characteristic_tests(), Equal_vector),
      (Det(), Det_tests(), Equal_scalar),
      (Inv(), Inv_tests(), Equal_maybe_matrix)])
def Tests():
  for (Functions, Test_cases, Equality) in Test_functions():
    for f in Functions:
      Name(f)
      for (x, y) in Test_cases:
        z = f(x)
        if not(Equality(z, y)):
          print((x, y, w))
def Times():
  for (fname, f, _, _, _) in Measure_functions():
    l = len(f)
    Names(f)
    Continue = [True for _ in f]
    Results = [[] for _ in f]
    n = 0
    while(Or(Continue)):
      for i in range(l):
        if Continue[i]:
          Reps = 0
          Result = 0
          while True:
            Reps += 1
            x = [[uniform(-1, 1) for _ in range(n)] for _ in range(n)]
            fi = f[i]
            Start = clock()
            _ = fi(x)
            End = clock()
            Result += End - Start
            if Result > 1:
              break
          Results[i] += [Result / Reps]
          if Reps == 1:
            Continue[i] = False
      n += 1
    Write(n + 1, l, "Time_" + fname, Results)
def Write(m, n, Filename, x):
  y = [[str(i)] + [str(x[j][i]) if i < len(x[j]) else "!" for j in range(n)] for i in range(m)]
  for i in range(n):
    Column_width = max([len(Row[i]) for Row in y])
    for j in range(m):
      y[j][i] = y[j][i].ljust(Column_width)
  File = open(Filename + ".dat", "w")
  File.write("\n".join([" ".join(y[i]) for i in range(m)]))
  File.close()
Newline()
for (Title, f) in Actions():
  print(Title + "\n" + len(Title) * "-" + "\n")
  f()
  Newline()
#############################################################################################################################